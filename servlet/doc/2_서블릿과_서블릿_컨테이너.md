## 서블릿과 서블릿 컨테이너

톰캣: 서블릿 컨테이너, WAS

서블릿: 특정 비즈니스 로직을 처리하는 서블릿 객체를 개발자가 만들어놓음. 각 로직마다 하나의 서블릿 객체만 생성.

- _not 싱글톤_! 싱글톤 패턴의 경우 객체로 딱 한번만 생성할 수 있도록 클래스 내부적으로 처리해놓음.
- 톰캣이 구조상 서블릿을 한번만 생성할 뿐임.

### 요청 처리 과정

1. 클라이언트가 서버로 요청을 보내면 컨테이너(톰캣)가 받음!
2. 컨테이너는 `request` 객체와 `response` 객체를 만듬.
3. 컨테이너는 자신이 관리 중인 서블릿 중 HTTP 요청의 URL에 맞는 적절한 서블릿을 찾고, 해당 서블릿의 `service` 메서드를 호출함! `service` 메서드의 매개변수에 `request` 객체와 `response` 객체를 전달.
4. 서블릿 객체는 하나지만 개별 요청마다 별개의 쓰레드를 생성하여, 해당 **쓰레드에서 서블릿이 요청을 처리**함!
5. 서블릿의 처리 결과는 `response` 객체를 통해 컨테이너로 넘기고, 컨테이너는 클라이언트에게 응답.
6. 서블릿 객체는 그대로 유지되지만, 쓰레드는 반환, `request` 객체와 `response` 객체도 JVM에게 반환!

---

## `서블릿 하나`로 `다수 요청을 처리`한다.

- 웹서버, WAS들은 기본적으로 멀티쓰레드로 처리됨!
- 복수의 클라이언트로부터 들어온 요청을 컨테이너에서는 서블릿 하나로 별개의 쓰레드에서 처리.

- 서블릿 하나를 공유하므로 서블릿은 상태를 지니면 안됨!
    - 인스턴스 변수, static 변수 등 존재하면 문제 발생 가능!
